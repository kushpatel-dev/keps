<div class="bg-gray-50 py-6 w-full color-{{ section.settings.color_scheme }}">
  <div class="w-full border-t border-b border-gray-200 bg-white flex flex-col md:flex-row shadow-md color-{{ section.settings.color_scheme }}">

    <!-- LEFT: Vertical Tabs (Horizontal on mobile) -->
    <div class="flex md:flex-col flex-row items-stretch border-b md:border-b-0 md:border-r border-gray-200">
      {% for block in section.blocks %}
        <button
          type="button"
          class="tab-btn transition-colors py-2 px-2.5 duration-200 border-gray-200 last:border-0 font-bold font-sans text-sm md:text-lg lg:text-xl uppercase tracking-wide
              h-14 w-full md:h-auto md:w-14 lg:h-auto lg:w-16 flex items-center justify-center
              {% if forloop.first %}bg-orange-950 text-white{% else %}bg-white text-orange-950 hover:bg-orange-950 hover:text-white{% endif %}
              border-b md:border-r md:last:border-b-0 md:border-b-0"
          data-tab-index="{{ forloop.index0 }}"
          style="writing-mode: vertical-rl; text-orientation: mixed; letter-spacing: 2px;"
          aria-selected="{% if forloop.first %}true{% else %}false{% endif %}">
          {{ block.settings.tab_title }}
        </button>
      {% endfor %}
    </div>

    <!-- RIGHT: Image and Info -->
    <div class="flex-1 flex flex-col p-4 md:p-8 gap-6 md:gap-10">
      {% for block in section.blocks %}
        <div class="tab-content w-full gap-6 md:gap-10 flex flex-col md:flex-row justify-center items-center xl:gap-96 xl:justify-start xl:items-center {% unless forloop.first %}hidden{% endunless %}" data-tab-index="{{ forloop.index0 }}">

          <!-- IMAGE Left -->
          <div class="image-block-container img-shake">
            {% if block.settings.main_image != blank %}
              <img
                height=""
                width=""
                src="{{ block.settings.main_image | image_url: width: 1000 }}"
                alt="{{ block.settings.heading | escape }}"
                class="image-block-main-img"
                loading="lazy">
            {% else %}
              <div class="image-block-placeholder">No Image</div>
            {% endif %}
          </div>

          <!-- TEXT Right -->
          <div class="contact-block-container">
            <div>
              <h3 class="contact-block-heading">
                {{ block.settings.heading }}
              </h3>
              <div class="contact-block-detail whitespace-pre-line">
                {{ block.settings.address }}
              </div>
              <div class="contact-block-detail">
                Tel: {{ block.settings.phone }}
              </div>
              <div class="contact-block-detail">
                Email: {{ block.settings.email }}
              </div>
              <div class="contact-block-opening-hours">
                {{ block.settings.opening_hours | newline_to_br }}
              </div>
            </div>
            {% if block.settings.button_label != blank %}
              <a
                href="{{ block.settings.button_link | default: '#' }}"
                class="contact-block-btn"
                target="_blank"
                rel="noopener">
                {{ block.settings.button_label }}
              </a>
            {% endif %}
          </div>


        </div>
      {% endfor %}
    </div>
  </div>
</div>

<style>
  @media (max-width: 767px) {
    .tab-btn[style] {
      writing-mode: horizontal-tb !important;
      text-orientation: unset !important;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const tabBtns = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');
  
    tabBtns.forEach((btn) => {
      btn.addEventListener('click', function () {
        tabBtns.forEach(b => {
          b.classList.remove('bg-orange-950', 'text-white');
          b.classList.add('bg-white', 'text-black', 'hover:bg-orange-950', 'hover:text-white');
          b.setAttribute('aria-selected', 'false');
        });
  
        tabContents.forEach(tc => tc.classList.add('hidden'));
  
        btn.classList.add('bg-orange-950', 'text-white');
        btn.classList.remove('bg-white', 'text-black', 'hover:bg-orange-950', 'hover:text-white');
        btn.setAttribute('aria-selected', 'true');
  
        const index = btn.getAttribute('data-tab-index');
        document.querySelector(`.tab-content[data-tab-index="${index}"]`).classList.remove('hidden');
      });
    });
  });
</script>
{% schema %}
  {
    "name": "Switchable Coffee",
    "settings": [
      {
        "type": "color_scheme",
        "id": "color_scheme",
        "label": "t:sections.all.colors.label",
        "default": "scheme-1"
      }
    ],
    "blocks": [
      {
        "type": "cafe",
        "name": "Cafe Contact",
        "settings": [
          {
            "type": "text",
            "id": "tab_title",
            "label": "Tab Title",
            "default": "Cafe Name"
          },
          {
            "type": "image_picker",
            "id": "main_image",
            "label": "Main Image"
          },
          {
            "type": "text",
            "id": "heading",
            "label": "Heading",
            "default": "Cafe Heading"
          },
          {
            "type": "textarea",
            "id": "address",
            "label": "Address",
            "default": "123 Main St, City"
          }, {
            "type": "text",
            "id": "phone",
            "label": "Phone",
            "default": "0123-456789"
          }, {
            "type": "text",
            "id": "email",
            "label": "Email",
            "default": "info@example.com"
          }, {
            "type": "textarea",
            "id": "opening_hours",
            "label": "Opening Hours",
            "default": "Mon-Fri: 7am - 7pm\nSat-Sun: 8am - 5pm"
          }, {
            "type": "text",
            "id": "button_label",
            "label": "Button Label",
            "default": "Contact Us"
          }, {
            "type": "url",
            "id": "button_link",
            "label": "Button Link"
          }
        ]
      }
    ],
    "max_blocks": 3,
    "presets": [
      {
        "name": "Switchable Coffee Contacts",
        "blocks": [
          {
            "type": "cafe"
          }, {
            "type": "cafe"
          }, {
            "type": "cafe"
          }
        ]
      }
    ]
  }
{% endschema %}