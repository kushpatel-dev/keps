{{ 'accordion.css' | asset_url | stylesheet_tag }}
{% schema %}
  {
    "name": "Product FAQ Accordion",
    "tag": "section",
    "class": "product-faq",
    "settings": [
      {
        "type": "text",
        "id": "heading",
        "label": "Heading",
        "default": "F.A.Qs"
      }, {
        "type": "text",
        "id": "description",
        "label": "Description",
        "default": "A playful, notebook-style accordion for product questions."
      }
    ],
    "blocks": [
      {
        "type": "faq",
        "name": "FAQ Item",
        "settings": [
          {
            "type": "text",
            "id": "question",
            "label": "Question",
            "default": "What is Quantum Entanglement?"
          }, {
            "type": "textarea",
            "id": "answer",
            "label": "Answer",
            "default": "Quantum Entanglement is when two particles become linked, so the state of one affects the otherâ€”no matter how far apart they are."
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Product FAQ Accordion",
        "category": "Product"
      }
    ]
  }
{% endschema %}

<section class="faq-section py-12 px-4">
  {% if section.settings.heading != blank %}
    <h2>{{ section.settings.heading }}</h2>
  {% endif %}

  {% if section.settings.description != blank %}
    <p class="description">{{ section.settings.description }}</p>
  {% endif %}

  <div class="accordion-container">
    {% for block in section.blocks %}
      <div class="accordion-item" {{ block.shopify_attributes }}>
        <button class="accordion-header">
          {{ block.settings.question }}
          <span class="icon">+</span>
        </button>
        <div class="accordion-content">
          <div class="accordion-body">
            <p>{{ block.settings.answer }}</p>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>

{% comment %} <a href="#top" class="badge-sticky">Back to top</a> {% endcomment %}
</section>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const headers = document.querySelectorAll(".accordion-header");
  
    headers.forEach((header) => {
      header.addEventListener("click", () => {
        const openItem = header.classList.contains("active");
  
        document.querySelectorAll(".accordion-header").forEach(h => h.classList.remove("active"));
        document.querySelectorAll(".accordion-content").forEach(c => c.style.maxHeight = null);
  
        if (!openItem) {
          header.classList.add("active");
          const content = header.nextElementSibling;
          content.style.maxHeight = content.scrollHeight + "px";
        }
      });
    });
  });
</script>